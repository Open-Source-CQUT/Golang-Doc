import{u as U,g as se,h as te,i as B,j as le,k as ie,t as ae,l as ne,m as $,n as R,p as me,w as O,q as t,v as re,R as M,x as ue,y as oe,z as ce,A as he,B as pe,C as ye,D as de,E as ve,F as ge,G as ke,H as be,I as T,J as j,K as fe,L as x,M as we}from"./app-CPiGw-Qs.js";const He=["/","/about.html","/cmd.html","/deb.html","/guide.html","/link.html","/play.html","/release.html","/community/database/Elasticsearch.html","/community/database/MongoDB.html","/community/database/Mysql.html","/community/database/","/community/database/Redis.html","/community/mirco/","/community/mirco/consul.html","/community/mirco/gprc.html","/community/mirco/kong.html","/community/mirco/protoc.html","/community/pkgs/","/essential/base/0.ready.html","/essential/base/1.grammer.html","/essential/base/10.datatype.html","/essential/base/30.constant.html","/essential/base/40.variable.html","/essential/base/45.inout.html","/essential/base/52.condition.html","/essential/base/55.loop.html","/essential/base/60.slice.html","/essential/base/62.string.html","/essential/base/65.map.html","/essential/base/67.pointer.html","/essential/base/69.func.html","/essential/base/75.struct.html","/essential/base/80.method.html","/essential/base/","/essential/impl/","/essential/senior/100.io.html","/essential/senior/105.reflect.html","/essential/senior/110.concurrency.html","/essential/senior/115.module.html","/essential/senior/120.test.html","/essential/senior/135.cgo.html","/essential/senior/140.pprof.html","/essential/senior/85.interface.html","/essential/senior/90.generic.html","/essential/senior/91.iterator.html","/essential/senior/92.types.html","/essential/senior/95.error.html","/essential/senior/996.postscript.html","/essential/senior/","/essential/std/0.intro.html","/essential/std/","/essential/std/encode.html","/essential/std/flag.html","/essential/std/http.html","/essential/std/log.html","/essential/std/math.html","/essential/std/net.html","/essential/std/sort.html","/essential/std/strconv.html","/essential/std/strings.html","/essential/std/template.html","/essential/std/time.html","/essential/std/unicode.html","/essential/std/unsafe.html","/community/pkgs/auth/Casbin.html","/community/pkgs/auth/","/community/pkgs/auth/jwt.html","/community/pkgs/config/","/community/pkgs/config/Viper.html","/community/pkgs/container/DockerAPI.html","/community/pkgs/container/","/community/pkgs/cross_anguage/","/community/pkgs/cross_anguage/gopher-lua.html","/community/pkgs/data_process/Cast.html","/community/pkgs/data_process/","/community/pkgs/data_process/copier.html","/community/pkgs/data_process/go-ini.html","/community/pkgs/data_process/size.html","/community/pkgs/di/","/community/pkgs/di/wire.html","/community/pkgs/draw/","/community/pkgs/draw/gg.html","/community/pkgs/logs/","/community/pkgs/logs/Zap.html","/community/pkgs/math/","/community/pkgs/math/decimal.html","/community/pkgs/orm/","/community/pkgs/orm/gorm.html","/community/pkgs/syscall/","/community/pkgs/syscall/gopsutils.html","/community/pkgs/tools/","/community/pkgs/tools/lancet.html","/community/pkgs/validate/","/community/pkgs/validate/Validator.html","/community/pkgs/web/HttpRouter.html","/community/pkgs/web/","/community/pkgs/web/gin.html","/community/pkgs/web/swag.html","/essential/impl/ds/0.slice.html","/essential/impl/ds/1.map.html","/essential/impl/ds/10.syncmap.html","/essential/impl/ds/2.string.html","/essential/impl/ds/6.channel.html","/essential/impl/ds/6.select.html","/essential/impl/err/3.nil.html","/essential/impl/err/4.defer.html","/essential/impl/err/5.panic.html","/essential/impl/network/0.netpoll.html","/essential/impl/runtime/15.sysmon.html","/essential/impl/runtime/7.gmp.html","/essential/impl/runtime/8.mem.html","/essential/impl/runtime/9.gc.html","/essential/impl/sync/0.mutex.html","/essential/impl/sync/15.cond.html","/essential/impl/sync/2.once.html","/essential/impl/sync/20.context.html","/essential/impl/sync/5.wg.html","/404.html","/community/","/essential/","/essential/impl/ds/","/essential/impl/err/","/essential/impl/network/","/essential/impl/runtime/","/essential/impl/sync/"],Re="SLIMSEARCH_QUERY_HISTORY",v=U(Re,[]),xe=()=>{const{queryHistoryCount:l}=x,i=l>0;return{enabled:i,queryHistories:v,addQueryHistory:a=>{i&&(v.value=Array.from(new Set([a,...v.value.slice(0,l-1)])))},removeQueryHistory:a=>{v.value=[...v.value.slice(0,a),...v.value.slice(a+1)]}}},A=l=>He[l.id]+("anchor"in l?`#${l.anchor}`:""),qe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:P}=x,g=U(qe,[]),Qe=()=>{const l=P>0;return{enabled:l,resultHistories:g,addResultHistory:i=>{if(l){const a={link:A(i),display:i.display};"header"in i&&(a.header=i.header),g.value=[a,...g.value.slice(0,P-1)]}},removeResultHistory:i=>{g.value=[...g.value.slice(0,i),...g.value.slice(i+1)]}}},Ce=l=>{const i=he(),a=B(),q=pe(),m=$(0),b=R(()=>m.value>0),y=ye([]);return de(()=>{const{search:d,terminate:Q}=ve(),k=fe(u=>{const{resultsFilter:f=r=>r,querySplitter:E,suggestionsFilter:C,...S}=i.value;u?(m.value+=1,d(u,a.value,S).then(r=>f(r,u,a.value,q.value)).then(r=>{m.value-=1,y.value=r}).catch(r=>{console.warn(r),m.value-=1,m.value||(y.value=[])})):y.value=[]},x.searchDelay-x.suggestDelay,{maxWait:5e3});O([l,a],([u])=>{k(u.join(" "))},{immediate:!0}),ge(()=>{Q()})}),{isSearching:b,results:y}};var Le=se({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:i}){const a=te(),q=B(),m=le(ie),{enabled:b,addQueryHistory:y,queryHistories:d,removeQueryHistory:Q}=xe(),{enabled:k,resultHistories:u,addResultHistory:f,removeResultHistory:E}=Qe(),C=b||k,S=ae(l,"queries"),{results:r,isSearching:V}=Ce(S),n=ne({isQuery:!0,index:0}),h=$(0),p=$(0),F=R(()=>C&&(d.value.length>0||u.value.length>0)),L=R(()=>r.value.length>0),D=R(()=>r.value[h.value]||null),Y=()=>{const{isQuery:e,index:s}=n;s===0?(n.isQuery=!e,n.index=e?u.value.length-1:d.value.length-1):n.index=s-1},z=()=>{const{isQuery:e,index:s}=n;s===(e?d.value.length-1:u.value.length-1)?(n.isQuery=!e,n.index=0):n.index=s+1},G=()=>{h.value=h.value>0?h.value-1:r.value.length-1,p.value=D.value.contents.length-1},J=()=>{h.value=h.value<r.value.length-1?h.value+1:0,p.value=0},K=()=>{p.value<D.value.contents.length-1?p.value+=1:J()},W=()=>{p.value>0?p.value-=1:G()},_=e=>e.map(s=>we(s)?s:t(s[0],s[1])),Z=e=>{if(e.type==="customField"){const s=ke[e.index]||"$content",[o,H=""]=be(s)?s[q.value].split("$content"):s.split("$content");return e.display.map(c=>t("div",_([o,...c,H])))}return e.display.map(s=>t("div",_(s)))},w=()=>{h.value=0,p.value=0,i("updateQuery",""),i("close")},N=()=>b?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},m.value.queryHistory),d.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:n.isQuery&&n.index===s}],onClick:()=>{i("updateQuery",e)}},[t(T,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:j,onClick:o=>{o.preventDefault(),o.stopPropagation(),Q(s)}})]))])):null,X=()=>k?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},m.value.resultHistory),u.value.map((e,s)=>t(M,{to:e.link,class:["slimsearch-result-item",{active:!n.isQuery&&n.index===s}],onClick:()=>{w()}},()=>[t(T,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(o=>_(o)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:j,onClick:o=>{o.preventDefault(),o.stopPropagation(),E(s)}})]))])):null;return me("keydown",e=>{if(l.isFocusing){if(L.value){if(e.key==="ArrowUp")W();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const s=D.value.contents[p.value];y(l.queries.join(" ")),f(s),a.push(A(s)),w()}}else if(k){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")z();else if(e.key==="Enter"){const{index:s}=n;n.isQuery?(i("updateQuery",d.value[s]),e.preventDefault()):(a.push(u.value[s].link),w())}}}}),O([h,p],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:l.queries.length?!L.value:!F.value}],id:"slimsearch-results"},l.queries.length?V.value?t(re,{hint:m.value.searching}):L.value?t("ul",{class:"slimsearch-result-list"},r.value.map(({title:e,contents:s},o)=>{const H=h.value===o;return t("li",{class:["slimsearch-result-list-item",{active:H}]},[t("div",{class:"slimsearch-result-title"},e||m.value.defaultTitle),s.map((c,ee)=>{const I=H&&p.value===ee;return t(M,{to:A(c),class:["slimsearch-result-item",{active:I,"aria-selected":I}],onClick:()=>{y(l.queries.join(" ")),f(c),w()}},()=>[c.type==="text"?null:t(c.type==="title"?ue:c.type==="heading"?oe:ce,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[c.type==="text"&&c.header?t("div",{class:"content-header"},c.header):null,t("div",Z(c))])])})])})):m.value.emptyResult:C?F.value?[N(),X()]:m.value.emptyHistory:m.value.emptyResult)}});export{Le as default};
